# REST API для управления местами отдыха

Проект представляет собой маленькое веб-приложение, реализованное на основе REST API для управления местами отдыха с поддержкой аутентификации пользователей.

## Основные возможности

- Аутентификация и авторизация через JWT токены
- Управление пользователями (регистрация, просмотр, обновление)
- Управление местами отдыха (добавление, просмотр)
- Добавление мест в избранное для пользователей
- Административные функции (назначение админов, просмотр всех пользователей)

## Технологии

- Python 3.13
- FastAPI
- PostgreSQL
- SQLAlchemy (асинхронная версия)
- Alembic (миграции)
- JWT (аутентификация)
- Docker

## Структура API

### Аутентификация
- Регистрация пользователя
- Получение JWT токена

### Пользователи (`/users`)
- `POST /users/add_wish_place/` - добавить место в избранное
- `GET /users/me/` - получить данные текущего пользователя

### Административные функции (`/admin_fanc`)
- `GET /admin_fanc/all_users/` - получить всех пользователей
- `GET /admin_fanc/{id}` - получить пользователя по ID
- `PUT /admin_fanc/assigning_admin/` - назначить администратора

### Места отдыха (`/places`)
- `GET /places/` - получить все места отдыха
- `POST /places/add/` - добавить новое место отдыха (только для админов)

## Модели данных

### Пользователь (User)
- email (str) - уникальный
- password (str)
- first_name (str)
- last_name (str)
- is_user (bool) - флаг обычного пользователя
- is_admin (bool) - флаг администратора
- wish_places - список избранных мест

### Место отдыха (Place)
- name (str) - уникальное название
- latitude (float) - широта
- longitude (float) - долгота

## Переменные окружения

Создайте файл `.env` в корне проекта со следующими переменными:

Настройки базы данных:

- DB_HOST="127.0.0.1"
- DB_PORT="5432"
- DB_NAME="name-db"
- DB_USER="user"
- DB_PASSWORD="password"

Настройки аутентификации:

- SECRET_KEY="your-secret-key-here"
- ALGORITHM="HS256"

## Формат URL для подключения к БД
```
DATABASE_URL="postgresql+asyncpg://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}"
```

## Запуск проекта

### Локальный запуск

1. Установите зависимости:
```
pip install -r req.txt
```
2. Настройте переменные окружения (база данных, JWT секрет и т.д.)

3. Примените миграции:
```
alembic upgrade head
```
4. Запустите сервер:
```
uvicorn app.main:app --reload
```

### Запуск в Docker
1. Соберите образ:
```
docker build -t places-api .
```
2. Запустите контейнер:
```
docker run -d -p 8000:8000 places-api
```

## Примеры запросов
Документация API будет доступна после запуска сервера:

Swagger UI: http://localhost:8000/docs

ReDoc: http://localhost:8000/redoc